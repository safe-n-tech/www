{{ define "main" }}
<section class="relative w-full pt-20 max-md:pb-36 max-md:-mb-20 md:pb-2 md:perso-background">
  <img class="md:hidden w-full h-full hero-bg-img object-cover object-bottom"
    src="/svgs/page-hero-bonnes-pratiques-bg.svg" alt="">
  <div class="container py-6 text-white ">
    {{ partial "breadcrumb" (dict "page" . "links" (slice "/thematiques")) }}
    <h1 class="text-h1 mt-10">{{ .Title}}</h1>
    <p class="text-h2 mt-4">{{ .Params.Subtitle }}</p>
  </div>
</section>


<section class="container my-20">
  <div>
    {{ if (.Params.VideoUrl) }}
    <iframe class="aspect-video" width="100%" src="{{ .Params.VideoUrl }}" frameborder="0"
      allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    {{ else }}
    <div class="p-10 border-secondary border-2 rounded-2xl bg-white">
      <p class="w-full italic text-center">Une vidéo présentant des témoignages arrive prochainement.</p>
    </div>
    {{ end }}
  </div>
  <p class="text-black mt-10">{{ .Description }}</p>

</section>

<section class="container text-dark_gray mt-20 mb-20">
  {{ $vulnerabilities := (where .Site.Pages "Section" "vulnerabilities") }}
  {{ $vulnerabilitiesLinked := where $vulnerabilities ".Params.thematique" "eq" .Params.uuid }}

  {{ if (gt (len $vulnerabilitiesLinked) 0) }}

  <nav class="grid-good-practice mt-5 grid-cols-1">
    {{ range $vulnerabilitiesLinked }}
      <div class="border-perso rounded-md bg-white p-5 ">
        <a href="{{ .Permalink }}" class="no-underline text-orange text-h3">
          {{ .Title }}
        </a>
        {{ if .Params.risks }}



          <div class="bg-white my-2 rounded-2xl">
            <button class="w-full  px-6 py-5 flex flex-row justify-between drop-down__item h-fit">
              <p class="text-h3 text-black text-left w-2/3">Risques encourus</p>
              <div class="self-center transition-all -rotate-90">
                <img src="/svgs/arrow_blue.svg" class="w-5 transition-all" />
              </div>
            </button>
            <div class="bg-white hidden px-6 pb-6 pt-2 rounded-2xl">
              {{ range .Params.risks }}
              <p>{{ . }}</p>
            {{ end }}
            </div>
          </div>
          <div class="bg-white my-2 rounded-2xl">
            <button class="w-full  px-6 py-5 flex flex-row justify-between drop-down__item h-fit">
              <p class="text-h3 text-black text-left w-2/3">Ne pas faire</p>
              <div class="self-center transition-all -rotate-90">
                <img src="/svgs/arrow_blue.svg" class="w-5 transition-all" />
              </div>
            </button>
            <div class="bg-white hidden px-6 pb-6 pt-2 rounded-2xl">
              <p>{{ .Title }}</p>
            </div>
          </div>
        {{ end }}
        {{ $goodPractices := (where .Site.Pages "Section" "good-practices") }}
        {{ $goodPracticesLinked := where $goodPractices ".Params.uuid" "in" .Params.goodPractices }}
        {{ if (gt (len $goodPracticesLinked) 0) }}
          <div class="mt-10">
            <h2 class="text-h4 mt-4">Les bonnes pratiques</h2>
            <div class="h-1 w-3/6 mt-2 bg-gradient-to-r from-blue-300 to-transparent mb-6"></div>


          </div>
        {{ end }}
      </div>
    {{ end }}
  </nav>
  {{ end }}


  <script>

    const dropDownItems = document.querySelectorAll(".drop-down__item");

    dropDownItems.forEach((item) => {
      item.addEventListener("click", () => {
        item.nextElementSibling.classList.toggle("hidden");
        item.querySelector("img").classList.toggle("rotate-90");
      });
    });
  </script>


</section>
{{ end}}
